<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>CSCI 445 Demo</title>
		<style>
			body { margin: 0; }
		</style>
	</head> 
	<script id="fragmentShader" type="x-shader/x-fragment">
		precision mediump float;

		varying vec3 normalInterp;
		varying vec3 vertPos;
		varying vec3 newPosition;

		const vec3 lightPos = vec3(5.0,5.0,5.0);
		
		const vec3 lightColor = vec3(0.0, 0.0, 0.5);
		const vec3 specColor = vec3(0.5, 0., 0.);
		const float shininess = 8.0;
		const float screenGamma = 2.2; // Assume the monitor is calibrated to the sRGB color space
        const vec3 ambient=vec3(0.25,0.25,0.25);
		void main() {

		  vec3 normal = normalize(normalInterp);
		  vec3 lightDir = normalize(lightPos - vertPos);

		  float lambertian = max(dot(lightDir,normal), 0.0);
		  float specular = 0.0;

		  if(lambertian > 0.0) {

			vec3 viewDir = normalize(-vertPos);

			// this is blinn phong
			vec3 halfDir = normalize(lightDir + viewDir);
			float specAngle = max(dot(halfDir, normal), 0.0);
			specular = pow(specAngle, shininess);
			   
			// this is phong (for comparison)
			  vec3 reflectDir = reflect(-lightDir, normal);
			  specAngle = max(dot(reflectDir, viewDir), 0.0);
			  // note that the exponent is different here
			  specular = pow(specAngle, shininess/4.0);
		  }
		  vec3 matColor = vec3(0,0.25,0);
		  vec3 colorLinear = 
		  					matColor 
		  				 	 + ambient
							 + lambertian * lightColor 
							 + specular * specColor
							;
		  gl_FragColor = vec4(colorLinear, 1.0);
		}
	</script>
	<script id="vertexShader" type="x-shader/x-vertex">
		
		varying vec3 normalInterp;
		varying vec3 vertPos;
		varying vec3 newPosition;

		void main(){
			newPosition=position;
			vec3 inputPosition=position;
			vec2 inputTexCoord=vec2(0.0,0.0);
			vec3 inputNormal=normal;

			mat4 projection=projectionMatrix;
			mat4 modelview=modelViewMatrix;
			mat4 normalMat=mat4 (normalMatrix);

			gl_Position = projection * modelview * vec4(inputPosition, 1.0);
			vec4 vertPos4 = modelview * vec4(inputPosition, 1.0);
			vertPos = vec3(vertPos4) / vertPos4.w;
		//	normalInterp = vec3(normalMat * vec4(inputNormal, 0.0));
			normalInterp=normalMatrix *normal;
		}
	</script>
	<body>
		<script type="module" src="/main.js"></script>
		<h1>Hello From CSCI 445</h1>
	</body>
</html>